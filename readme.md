# Microservice Architecture with RabbitMQ

Этот проект представляет собой микросервисную архитектуру с использованием RabbitMQ для обмена сообщениями между сервисами. Каждый микросервис отвечает за определенную задачу, взаимодействуя с другими через очереди сообщений.

## Структура проекта

```plaintext
microservice_architecture/
│
├── features/
│   ├── src/
│   │   └── features.py           # Микросервис для обработки feature-данных
│   ├── requirements.txt          # Зависимости для features.py
│   ├── Dockerfile                # Dockerfile для контейнеризации features
│   └── wait-for-rabbitmq.sh      # Скрипт ожидания доступности RabbitMQ
│
├── metrics/
│   ├── src/
│   │   └── metrics.py            # Микросервис для обработки метрик
│   ├── logs/
│   │   └── metric_log.csv        # Лог-файл метрик (если отсутствует, он создается автоматически)
│   ├── requirements.txt          # Зависимости для metrics.py
│   ├── Dockerfile                # Dockerfile для контейнеризации metrics
│   └── wait-for-rabbitmq.sh      # Скрипт ожидания доступности RabbitMQ
│
├── model/
│   ├── src/
│   │   ├── model.py              # Микросервис для работы с моделью машинного обучения
│   │   └── myfile.pkl            # Сериализованная модель машинного обучения
│   ├── requirements.txt          # Зависимости для model.py
│   ├── Dockerfile                # Dockerfile для контейнеризации model
│   └── wait-for-rabbitmq.sh      # Скрипт ожидания доступности RabbitMQ
│
├── plot/
│   ├── src/
│   │   └── plot.py               # Микросервис для визуализации данных
│   ├── requirements.txt          # Зависимости для plot.py
│   ├── Dockerfile                # Dockerfile для контейнеризации plot
│   └── wait-for-rabbitmq.sh      # Скрипт ожидания доступности RabbitMQ
│
├── docker-compose.yml            # Файл для запуска всех микросервисов через Docker Compose
└── logs/
    └── metric_log.csv            # Общий лог-файл для обмена данными между сервисами
    └── error_distribution.png    # Гистограмма распределения абсолютной ошибки предсказания
```

## Предварительные требования

Для запуска проекта вам потребуется:
- [Docker](https://www.docker.com/)
- [Docker Compose](https://docs.docker.com/compose/)

## Запуск проекта

1. Клонируйте репозиторий:
   ```bash
   git clone <ссылка-на-репозиторий>
   cd microservice_architecture
   ```

2. Соберите и запустите все контейнеры с помощью Docker Compose:
   ```bash
   docker-compose up --build
   ```

3. Интерфейс RabbitMQ будет доступен по адресу:
   ```
   http://localhost:15672
   ```
   Используйте логин `user` и пароль `password` для входа.

4.  В директории ./logs будет собираться статистика по предсказаниям

## Как это работает

### Микросервисы

1. **features.py**:
   - Отвечает за обработку данных признаков (features).
   - Получает задачи из очереди RabbitMQ и выполняет их.

2. **metrics.py**:
   - Генерирует и записывает метрики в `metric_log.csv`.
   - Работает в синхронизации с другими сервисами.

3. **model.py**:
   - Использует модель машинного обучения, сохраненную в `myfile.pkl`, для выполнения предсказаний.
   - Общается с другими сервисами через RabbitMQ.

4. **plot.py**:
   - Создает визуализации на основе данных, полученных из метрик.

### RabbitMQ

RabbitMQ используется для обмена сообщениями между сервисами:
- Каждый микросервис подключается к очередям RabbitMQ и обменивается задачами.

### Лог-файл

Файл `logs/metric_log.csv` используется для хранения данных, обрабатываемых микросервисами. Убедитесь, что он существует в корневой папке проекта перед запуском.
